{% extends "base.html" %}
{% load static %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/movie_detail.css' %}">
{% endblock %}

{% block content %}
<div class="movie-detail-container">
    <!-- –¢—Ä–µ–π–ª–µ—Ä -->
    {% if movie.trailer_url %}
    <div class="trailer-section">
        <h2>–¢—Ä–µ–π–ª–µ—Ä</h2>
        <div class="trailer-container">
            <iframe 
                width="100%" 
                height="500" 
                src="{{ movie.trailer_url }}" 
                frameborder="0" 
                allowfullscreen>
            </iframe>
        </div>
    </div>
    {% endif %}

    <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∏–ª—å–º–µ -->
    <div class="movie-info-section">
        <div class="movie-header">
            {% if movie.poster %}
            <img src="{{ movie.poster.url }}" alt="{{ movie.title }}" class="movie-poster-large">
            {% else %}
            <img src="{% static 'images/default-poster.jpg' %}" alt="{{ movie.title }}" class="movie-poster-large">
            {% endif %}
            
            <div class="movie-basic-info">
                <h1>{{ movie.title }} ({{ movie.release_year }})</h1>
                <div class="movie-meta">
                    <span class="genre">{{ movie.genre }}</span>
                    <span class="duration">{{ movie.duration }} –º–∏–Ω.</span>
                    <span class="price">{{ movie.price }} ‚ÇΩ</span>
                </div>
                
                <p class="description">{{ movie.description }}</p>
                
                {% if user.is_authenticated %}
                <a href="{% url 'purchase_movie' movie.movie_id %}" ><button class="buy-btn-large">üõí –ö—É–ø–∏—Ç—å –∑–∞ {{ movie.price }} ‚ÇΩ</button></a>
                </button>
                {% else %}
                <a href="{% url 'login' %}" class="login-btn-large">
                    üîí –í–æ–π—Ç–∏ –¥–ª—è –ø–æ–∫—É–ø–∫–∏
                </a>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- –°—ä–µ–º–æ—á–Ω–∞—è –≥—Ä—É–ø–ø–∞ -->
    <div class="crew-section">
        <h2>–°—ä–µ–º–æ—á–Ω–∞—è –≥—Ä—É–ø–ø–∞</h2>
        
        {% for role_name, crew_members in crew_by_roles.items %}
        <div class="crew-role-group">
            <h3>{{ role_name }}</h3>
            <div class="crew-members">
                {% for crew in crew_members %}
                <div class="crew-member">
                    <a href="{% url 'artist_detail' crew.artist.artist_id %}" class="artist-link">
                        <div class="artist-avatar">
                            <!-- –§–æ—Ç–æ –∞–∫—Ç–µ—Ä–∞ -->
                            {{ crew.artist.first_name|first }}{{ crew.artist.last_name|first }}
                        </div>
                        <div class="artist-info">
                            <strong>{{ crew.artist.first_name }} {{ crew.artist.last_name }}</strong>
                            {% if crew.character_name %}
                            <span class="character">–≤ —Ä–æ–ª–∏ {{ crew.character_name }}</span>
                            {% endif %}
                        </div>
                    </a>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}