{% extends "base.html" %}
{% load static %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/home.css' %}">
{% endblock %}

{% block content %}
<!-- –ü–∞–Ω–µ–ª—å —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ -->
<div class="filters-panel">
    <h3>–ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è</h3>
    <form method="get" class="filter-form">
        <div class="filter-grid">
            <!-- –ü–æ–∏—Å–∫ -->
            <div class="filter-group full-width">
                <label>–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é:</label>
                {{ form.search }}
            </div>
            
            <!-- –ñ–∞–Ω—Ä –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ -->
            <div class="filter-group">
                <label>–ñ–∞–Ω—Ä:</label>
                {{ form.genre }}
            </div>
            
            <div class="filter-group">
                <label>–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:</label>
                {{ form.sort_by }}
            </div>
            
            <!-- –ì–æ–¥ –≤—ã–ø—É—Å–∫–∞ -->
            <div class="filter-group">
                <label>–ì–æ–¥ –æ—Ç:</label>
                {{ form.min_year }}
            </div>
            
            <div class="filter-group">
                <label>–ì–æ–¥ –¥–æ:</label>
                {{ form.max_year }}
            </div>
            
            <!-- –¶–µ–Ω–∞ -->
            <div class="filter-group">
                <label>–¶–µ–Ω–∞ –æ—Ç:</label>
                {{ form.min_price }}
            </div>
            
            <div class="filter-group">
                <label>–¶–µ–Ω–∞ –¥–æ:</label>
                {{ form.max_price }}
            </div>
        </div>
        
        <!-- –ö–Ω–æ–ø–∫–∏ -->
        <div class="filter-actions">
            <button type="submit" class="btn-filter apply-btn">–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
            <a href="{% url 'home' %}" class="btn-filter reset-btn">–°–±—Ä–æ—Å–∏—Ç—å –≤—Å—ë</a>
        </div>
    </form>
</div>

<!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö -->
<div class="results-info">
    <div class="results-count">
        <span>–ù–∞–π–¥–µ–Ω–æ —Ñ–∏–ª—å–º–æ–≤: <strong>{{ results_count }}</strong></span>
    </div>
    
    {% if results_count > 0 %}
    <div class="export-buttons">
        <span>–°–∫–∞—á–∞—Ç—å —Å–ø–∏—Å–æ–∫:</span>
        <a href="?{{ request.GET.urlencode }}&export=txt" class="btn-export">TXT</a>
        <a href="?{{ request.GET.urlencode }}&export=pdf" class="btn-export">PDF</a>
        <a href="?{{ request.GET.urlencode }}&export=docx" class="btn-export">DOCX</a>
    </div>
    {% endif %}
</div>

<!-- –°–µ—Ç–∫–∞ —Ñ–∏–ª—å–º–æ–≤ -->
<div class="movies-grid">
    {% for movie in movies_list %}
    <div class="movie-card">
        <a href="/movie/{{ movie.movie_id }}/" class="movie-card-link">
            <div class="movie-poster">
                {% if movie.poster %}
                    <img src="{{ movie.poster.url }}" alt="{{ movie.title }}">
                {% else %}
                    <img src="{% static 'images/default-poster.jpg' %}" alt="{{ movie.title }}">
                {% endif %}
                
                <div class="movie-price">{{ movie.price }} ‚ÇΩ</div>
            </div>
            
            <div class="movie-info">
                <h3 class="movie-title">{{ movie.title }}</h3>
                <p class="movie-details">{{ movie.release_year }} ‚Ä¢ {{ movie.genre }}</p>   
            </a>
                
                <div class="movie-actions">
                    {% if user.is_authenticated %}
                        <a href="{% url 'purchase_movie' movie.movie_id %}" ><button class="buy-btn">üõí –ö—É–ø–∏—Ç—å</button></a>
                    {% else %}
                        <a href="{% url 'login' %}" class="login-btn">üîí –í–æ–π—Ç–∏ –¥–ª—è –ø–æ–∫—É–ø–∫–∏</a>
                    {% endif %}
                </div>
            </div>
    </div>
    {% empty %}
    <div class="no-movies">
        <p>–§–∏–ª—å–º—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞.</p>
    </div>
    {% endfor %}
</div>
{% endblock %}